{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./decoder.js","webpack:///./iolanta.js","webpack:///./app.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Datatypes","http://www.w3.org/2001/XMLSchema#boolean","true","false","http://www.w3.org/2001/XMLSchema#dateTime","Date","parse","ContentType","construct","select","interpret_sparql_value","datum","datatype","type_function","console","log","concat","Decoder","data","results","bindings","map","source","result","Iolanta","token","_classCallCheck","this","content_type","query","self","Promise","resolve","fetch","url","method","headers","accept","authorization","Content-Type","body","URLSearchParams","toString","then","response","json","clean_data","interpret_sparql_response","query_id","type","arguments","length","undefined","interpreter","TOKEN","Vue","component","props","template","dataset","methods","update","app","execute_stored_query","created","category","el"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","// RDF types to JavaScript types\nconst Datatypes = {\n    'http://www.w3.org/2001/XMLSchema#boolean': function (value) {\n        // Boolean\n        return {\n            \"true\": true,\n            \"false\": false\n        }[value]\n    },\n    'http://www.w3.org/2001/XMLSchema#dateTime': function (value) {\n        // Datetime\n        return new Date(Date.parse(value));\n    }\n};\n\nexport const ContentType = {\n    construct: 'application/rdf+json',\n    select: 'application/sparql-results+json'\n};\n\nexport function interpret_sparql_value(datum) {\n    let value = datum.value,\n        datatype = datum.datatype;\n\n    if (datatype) {\n        // We have data type defined, we are expected to convert literal\n        // to assume that data type.\n        let type_function = Datatypes[datatype];\n\n        if (type_function) {\n            return type_function(value);\n        } else {\n            console.log(\n                `Datatype ${datatype} has no defined conversion `\n                + `function. Value: ${value}.`\n            )\n        }\n    }\n\n    return value;\n}\n\nconst Decoder = {\n    construct: function(data) {\n        return data;\n    },\n    select: function(data) {\n        // Present a SPARQL query result in a human friendly form\n        // Suitable for: application/sparql-results+json\n        return data.results.bindings.map(function(source) {\n            // FIXME this is dirty but https://stackoverflow.com/a/14810722/1245471\n            let result = [];\n            for (let key in source) {\n                if (source.hasOwnProperty(key)) {\n                    result[key] = interpret_sparql_value(source[key]);\n                }\n            }\n            return result\n        })\n    }\n};\n\nexport { Decoder };\n","import { Decoder, ContentType } from './decoder';\n\n\nexport class Iolanta {\n    // This is a primitive class encapsulating a SPARQL endpoint.\n    constructor(token) {\n        // this.url = url;\n        this.token = token;\n\n        // FIXME cannot make it a class property, Chrome doesn't like it\n        // Though MDN approves:\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes#Field_declarations\n        this.content_type = 'application/sparql-results+json';\n    }\n\n    static interpret_sparql_response(data) {\n\n    }\n\n    execute(query) {\n        let self = this;\n        return new Promise(function(resolve) {\n            fetch(self.url, {\n                method: 'POST',\n                mode: 'cors',\n                headers: {\n                    accept: self.content_type,\n                    authorization: `Bearer ${self.token}`,\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                },\n                body: new URLSearchParams({\n                    query: query\n                }).toString()\n            }).then(function(response) {\n                response.json().then(function(data) {\n                    console.log(data);\n                    let clean_data = Iolanta.interpret_sparql_response(data);\n                    console.log(clean_data);\n                    resolve(clean_data);\n                })\n            });\n        });\n    }\n\n    execute_stored_query(query_id, type='select') {\n        let self = this,\n            url = `https://api.data.world/v0/queries/${query_id}/results`;\n\n        let interpreter = Decoder[type];\n\n        return new Promise(function(resolve) {\n            fetch(url, {\n                method: 'GET',\n                mode: 'cors',\n                headers: {\n                    accept: ContentType[type],\n                    authorization: `Bearer ${self.token}`,\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).then(function(response) {\n                response.json().then(function(data) {\n                    console.log(data);\n                    let clean_data = interpreter(data);\n                    resolve(clean_data);\n                })\n            });\n        });\n    }\n}\n","import { Iolanta } from \"./iolanta\";\n\nlet TOKEN =\n    'eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJwcm9kLXVzZXItY2xpZW50OnlldGktcmVhZG9' +\n    'ubHkiLCJpc3MiOiJhZ2VudDp5ZXRpLXJlYWRvbmx5Ojo1Y2Q4YmE5Zi01ZGQ2LTQ4MWU' +\n    'tOWUxOC04NTIwYjIxN2I0Y2QiLCJpYXQiOjE1NTYyMDcwMjUsInJvbGUiOlsidXNlcl9' +\n    'hcGlfcmVhZCIsInVzZXJfYXBpX3dyaXRlIl0sImdlbmVyYWwtcHVycG9zZSI6dHJ1ZSw' +\n    'ic2FtbCI6e319.-7tuD6sdMhjEADykZ0QoMWAUfoXcHXlkpS3KRmLtN465A6wuK2fVtu' +\n    '4y3OO2kqRcPZRkUMUGzAEi_LmCy5uQQQ';\n\n\nVue.component('datadotworld-table', {\n    props: ['query_id'],\n    template: `\n<table class=\"ui left aligned table\">\n    <thead>\n    <th>Name</th>\n    <th>URL</th>\n    <th>Description</th>\n    <th>Updated Time</th>\n    <th>Online?</th>\n    </thead>\n    <tbody>\n        <tr v-for=\"row in dataset\">\n            <td>{{ row.name }}</td>\n            <td>{{ row.url }}</td>\n            <td>{{ row.description }}</td>\n            <td>{{ row.last_updated }}</td>\n            <td v-if=\"row.is_online\">\n                <i class=\"check icon\"></i>\n            </td>\n            <td v-else-if=\"row.is_online == false\">\n                <i class=\"times icon\"></i>\n            </td>\n            <td v-else>\n\n            </td>\n        </tr>\n    </tbody>\n</table>`,\n    data: function() {\n        return {\n            dataset: null\n        }\n    },\n    methods: {\n        update: function() {\n            // noinspection SpellCheckingInspection\n            let app = this;\n\n            new Iolanta(TOKEN).execute_stored_query(\n                app.query_id\n            ).then(function (data) {\n                app.dataset = data;\n            });\n\n            /*\n            FIXME I will continue experimentation with this a bit later\n\n            new Iolanta(token).execute_stored_query(\n                '10b74064-7b75-4a79-9022-7b8bdca67f5b',\n                'construct'\n            ).then(function (data) {\n                console.log(data);\n            })\n            */\n        }\n    },\n    created: function() {\n        this.update();\n    }\n});\n\n\nVue.component('category-menu', {\n    props: ['query_id'],\n    data: function() {\n        return {\n            dataset: null\n        }\n    },\n    template: `\n        <div>{{ dataset }}</div>\n    `,\n    methods: {\n        update: function() {\n            let app = this;\n            new Iolanta(TOKEN).execute_stored_query(\n                this.query_id\n            ).then(function (data) {\n                app.dataset = data.map(function(datum) { return datum.category });\n                console.log(app.dataset);\n            });\n        },\n    },\n    created: function () {\n        this.update();\n    }\n});\n\n\nlet app = new Vue({\n    el: '#app',\n});\n"],"sourceRoot":""}